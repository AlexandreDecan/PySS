statechart:
  name: Destination is reached
  initial: waiting
  states:
    - name: waiting
      transitions:
        - target: floorSelected
          event: step
          guard: step.processed('floorSelected')  # Avoid step.consumed('floorSelected') here, as it does not imply its processing
    - name: floorSelected
      transitions:
        - target: destinationReached
          event: step
          guard: step.context['current'] == step.context['destination']
    - name: destinationReached
      transitions:
        - target: final
          event: stop
        - target: floorSelected
          event: step
          guard: step.processed('floorSelected')
    - name: final
      type: final